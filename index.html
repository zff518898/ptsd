<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>创伤后应激症状筛查（PCL-5）</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: #f5f7fa; color: #333; line-height: 1.6; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background-color: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); overflow: hidden; }
        
        header {
            background: linear-gradient(135deg, #b24592 0%, #f15f79 100%);
            color: white; padding: 30px; text-align: center;
        }
        header h1 { font-size: 2.2rem; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 15px; }
        .subtitle { font-size: 1.2rem; opacity: 0.9; margin-bottom: 20px; }
        .disclaimer {
            background-color: rgba(255, 255, 255, 0.15);
            border-left: 4px solid #ffcc00; padding: 15px; border-radius: 5px;
            text-align: left; margin-top: 20px; font-size: 0.95rem;
        }
        
        .card { background-color: white; border-radius: 10px; padding: 30px; margin: 20px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); }
        .hidden { display: none !important; }
        
        .options-info {
            display: flex; flex-wrap: wrap; justify-content: space-between; margin: 25px 0; gap: 10px;
        }
        .option-item {
            flex: 1; min-width: 120px; background-color: #f0f5ff; padding: 12px; border-radius: 8px; text-align: center;
        }
        .option-label {
            display: inline-block; width: 30px; height: 30px; background-color: #b24592;
            color: white; border-radius: 50%; line-height: 30px; margin-right: 10px; font-weight: bold;
        }
        
        .btn-primary, .btn-secondary {
            padding: 14px 28px; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: 600;
            cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-primary { background-color: #b24592; color: white; }
        .btn-primary:hover { background-color: #9b3a7a; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(178, 69, 146, 0.3); }
        .btn-secondary { background-color: #f0f5ff; color: #b24592; border: 2px solid #b24592; }
        .btn-secondary:hover { background-color: #e1e9ff; }
        .actions { display: flex; justify-content: center; gap: 20px; margin-top: 30px; }
        
        #questions-container { margin: 25px 0; }
        .question { margin-bottom: 25px; padding-bottom: 25px; border-bottom: 1px solid #eee; }
        .question:last-child { border-bottom: none; }
        .question-text { font-size: 1.1rem; margin-bottom: 15px; color: #333; font-weight: 600; }
        .options { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }
        .option {
            background-color: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 12px 15px;
            cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center;
        }
        .option:hover { background-color: #e9ecef; }
        .option.selected { background-color: #f9e1f0; border-color: #b24592; color: #b24592; }
        .option input { margin-right: 10px; }
        .navigation {
            display: flex; justify-content: space-between; align-items: center; margin-top: 30px;
            padding-top: 20px; border-top: 1px solid #eee;
        }
        #page-info { font-weight: 600; color: #b24592; }
        
        .progress-container { margin: 20px 0; }
        .progress-bar { height: 10px; background-color: #e9ecef; border-radius: 5px; overflow: hidden; }
        .progress-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #b24592, #f15f79); border-radius: 5px; transition: width 0.5s ease; }
        .progress-text { text-align: center; margin-top: 10px; font-weight: 600; color: #b24592; }
        
        .score-category { margin-bottom: 30px; padding: 20px; background-color: #f8f9fa; border-radius: 10px; }
        .score-category h3 { margin-bottom: 15px; color: #b24592; font-size: 1.4rem; }
        .score-bar { height: 25px; background-color: #e9ecef; border-radius: 12px; overflow: hidden; margin-bottom: 15px; }
        .score-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #b24592, #f15f79); border-radius: 12px; transition: width 1.5s ease; }
        .score-details { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .score-details p { margin: 0; font-weight: 600; }
        
        .ptsd-card {
            border-radius: 10px; padding: 25px; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
        }
        .ptsd-card:hover { transform: translateY(-5px); }
        .ptsd-card h3 { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; font-size: 1.4rem; }
        
        .level-normal { background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border-left: 6px solid #28a745; }
        .level-mild { background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); border-left: 6px solid #ffc107; }
        .level-moderate { background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%); border-left: 6px solid #fd7e14; }
        .level-severe { background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%); border-left: 6px solid #dc3545; }
        
        #interpretation, #recommendations { margin-top: 30px; padding: 25px; background-color: #f8f9fa; border-radius: 10px; }
        #interpretation h3, #recommendations h3 { margin-bottom: 15px; color: #b24592; display: flex; align-items: center; gap: 10px; }
        .recommendation-item { background-color: white; padding: 15px; margin-bottom: 15px; border-radius: 8px; border-left: 4px solid #b24592; }
        
        footer { background-color: #f8f9fa; padding: 20px; text-align: center; color: #666; font-size: 0.9rem; line-height: 1.5; border-top: 1px solid #eee; }
        
        @media (max-width: 768px) {
            .container { border-radius: 0; }
            header h1 { font-size: 1.8rem; flex-direction: column; gap: 10px; }
            .card { padding: 20px; margin: 10px; }
            .options { grid-template-columns: 1fr; }
            .score-details { grid-template-columns: 1fr; gap: 10px; }
            .actions { flex-direction: column; }
            .btn-primary, .btn-secondary { width: 100%; margin-bottom: 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-brain"></i> 创伤后应激症状筛查（PCL-5）</h1>
            <p class="subtitle">基于DSM-5的创伤后应激障碍检查表</p>
            <div class="disclaimer">
                <p><strong>重要提示：</strong>本量表用于筛查过去一个月内因创伤事件引起的症状。结果仅供参考，不能替代专业临床诊断。如有需要，请寻求心理健康专业人士的帮助。</p>
            </div>
        </header>

        <main>
            <!-- 说明部分 -->
            <section id="instructions" class="card">
                <h2><i class="fas fa-info-circle"></i> 测试说明 心鸟心理测试</h2>
                <p>请根据您在<strong>过去一个月</strong>的经历，评估每个问题对您的困扰程度。请选择最符合您实际情况的选项。</p>
                <p>每个问题有5个选项：</p>
                <div class="options-info">
                    <div class="option-item"><span class="option-label">0</span> 一点也不</div>
                    <div class="option-item"><span class="option-label">1</span> 有一点</div>
                    <div class="option-item"><span class="option-label">2</span> 中等程度</div>
                    <div class="option-item"><span class="option-label">3</span> 相当程度</div>
                    <div class="option-item"><span class="option-label">4</span> 非常严重</div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progress-text">请回答所有问题以获得准确结果</div>
                </div>
                <button id="start-btn" class="btn-primary">开始测试</button>
            </section>

            <!-- 问卷部分 -->
            <section id="questionnaire" class="card hidden">
                <h2><i class="fas fa-clipboard-list"></i> PCL-5 量表</h2>
                <div id="questions-container"></div>
                <div class="navigation">
                    <button id="prev-btn" class="btn-secondary"><i class="fas fa-arrow-left"></i> 上一题</button>
                    <span id="page-info">第 <span id="current-page">1</span> 题 / 共 20 题</span>
                    <button id="next-btn" class="btn-secondary">下一题 <i class="fas fa-arrow-right"></i></button>
                </div>
                <button id="submit-btn" class="btn-primary hidden">查看结果</button>
            </section>

            <!-- 结果部分 -->
            <section id="results" class="card hidden">
                <h2><i class="fas fa-chart-bar"></i> 测试结果</h2>
                
                <div class="score-category">
                    <h3>您的PTSD症状总分</h3>
                    <div class="score-bar">
                        <div id="total-bar" class="score-fill"></div>
                    </div>
                    <div class="score-details">
                        <p>总分: <span id="total-score">0</span> / 80</p>
                        <p>症状水平: <span id="severity-level">轻度</span></p>
                        <p>临床参考: <span id="clinical-cutoff">低于阈值</span></p>
                    </div>
                </div>
                
                <div id="ptsd-summary">
                    <h3><i class="fas fa-heartbeat"></i> 症状概述</h3>
                    <div id="ptsd-summary-content"></div>
                </div>
                
                <div id="interpretation">
                    <h3><i class="fas fa-comment-medical"></i> 结果解读</h3>
                    <div id="interpretation-content"></div>
                </div>
                
                <div id="recommendations">
                    <h3><i class="fas fa-hands-helping"></i> 建议</h3>
                    <div id="recommendations-content"></div>
                </div>
                
                <div class="actions">
                    <button id="restart-btn" class="btn-secondary"><i class="fas fa-redo"></i> 重新测试</button>
                    <button id="print-btn" class="btn-secondary"><i class="fas fa-print"></i> 打印结果</button>
                </div>
            </section>
        </main>

        <footer>
            <p>创伤后应激症状筛查（PCL-5）基于DSM-5标准</p>
            <p>参考: Weathers, F.W., Litz, B.T., Keane, T.M., Palmieri, P.A., Marx, B.P., & Schnurr, P.P. (2013). The PTSD Checklist for DSM-5 (PCL-5).</p>
            <p>© 2023 心理健康工具 | 仅供教育参考使用</p>
        </footer>
    </div>

    <script>
        // PCL-5 完整20个问题
        const pcl5Questions = [
            { id: 1, text: "反复、令人不安的记忆、想法或心象？", category: "intrusion" },
            { id: 2, text: "反复、令人不安的梦境？", category: "intrusion" },
            { id: 3, text: "突然感觉或表现得好像创伤再次发生（仿佛再次体验）？", category: "intrusion" },
            { id: 4, text: "当有些事情让您想起创伤经历时，感到非常痛苦？", category: "intrusion" },
            { id: 5, text: "当有些事情让您想起创伤经历时，产生强烈的身体反应（如心跳加速、呼吸困难、出汗）？", category: "intrusion" },
            { id: 6, text: "努力避免与创伤有关的记忆、想法或感受？", category: "avoidance" },
            { id: 7, text: "努力避免能够唤起创伤记忆的外部提示（如人、地方、对话、活动、物体或情境）？", category: "avoidance" },
            { id: 8, text: "难以记住创伤经历的重要部分？", category: "cognition" },
            { id: 9, text: "对自己、他人或世界持有强烈的消极信念（如“我很糟糕”、“我不可信任”、“世界是绝对危险的”）？", category: "cognition" },
            { id: 10, text: "因创伤事件或其后果而责怪自己或他人？", category: "cognition" },
            { id: 11, text: "强烈的消极情绪，如恐惧、愤怒、内疚或羞耻？", category: "cognition" },
            { id: 12, text: "对以前喜欢的活动失去兴趣？", category: "cognition" },
            { id: 13, text: "与他人感到疏远或隔离？", category: "cognition" },
            { id: 14, text: "难以体验积极情绪（如无法感到快乐或爱）？", category: "cognition" },
            { id: 15, text: "易怒、愤怒或攻击行为？", category: "arousal" },
            { id: 16, text: "冒险行为或可能伤害自己的行为？", category: "arousal" },
            { id: 17, text: "过度警觉（例如，即使没有危险也保持警惕）？", category: "arousal" },
            { id: 18, text: "惊跳反应过强？", category: "arousal" },
            { id: 19, text: "注意力难以集中？", category: "arousal" },
            { id: 20, text: "睡眠困难（如难以入睡、易醒或不安的睡眠）？", category: "arousal" }
        ];

        // 严重程度分级 (总分0-80)
        const severityLevels = [
            { min: 0, max: 20, level: "正常", class: "level-normal", desc: "无明显PTSD症状" },
            { min: 21, max: 32, level: "轻度", class: "level-mild", desc: "可能有轻度PTSD症状" },
            { min: 33, max: 45, level: "中度", class: "level-moderate", desc: "达到临床参考阈值，建议进一步评估" },
            { min: 46, max: 60, level: "重度", class: "level-severe", desc: "症状严重，强烈建议专业评估" },
            { min: 61, max: 80, level: "极重度", class: "level-severe", desc: "症状极重度，急需专业干预" }
        ];

        // 应用状态
        let currentQuestion = 1;
        let answers = new Array(pcl5Questions.length).fill(null);

        // DOM元素
        const instructionsSection = document.getElementById('instructions');
        const questionnaireSection = document.getElementById('questionnaire');
        const resultsSection = document.getElementById('results');
        const questionsContainer = document.getElementById('questions-container');
        const startBtn = document.getElementById('start-btn');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const restartBtn = document.getElementById('restart-btn');
        const printBtn = document.getElementById('print-btn');
        const currentPageSpan = document.getElementById('current-page');
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('PCL-5 初始化...');
            
            startBtn.addEventListener('click', startQuestionnaire);
            prevBtn.addEventListener('click', goToPrevQuestion);
            nextBtn.addEventListener('click', goToNextQuestion);
            submitBtn.addEventListener('click', showResults);
            restartBtn.addEventListener('click', restartQuestionnaire);
            printBtn.addEventListener('click', printResults);
            
            renderQuestion();
            updateProgress();
        });

        function startQuestionnaire() {
            instructionsSection.classList.add('hidden');
            questionnaireSection.classList.remove('hidden');
            resultsSection.classList.add('hidden');
            currentQuestion = 1;
            renderQuestion();
        }

        function renderQuestion() {
            questionsContainer.innerHTML = '';
            const question = pcl5Questions[currentQuestion - 1];
            
            const questionElement = document.createElement('div');
            questionElement.className = 'question';
            questionElement.innerHTML = `
                <div class="question-text">${question.id}. ${question.text}</div>
                <div class="options">
                    ${[0, 1, 2, 3, 4].map(value => `
                        <label class="option ${answers[currentQuestion - 1] === value ? 'selected' : ''}">
                            <input type="radio" name="question-${question.id}" value="${value}" 
                                   ${answers[currentQuestion - 1] === value ? 'checked' : ''}>
                            <span class="option-label">${value}</span> ${getOptionText(value)}
                        </label>
                    `).join('')}
                </div>
            `;
            
            const radioInputs = questionElement.querySelectorAll('input[type="radio"]');
            radioInputs.forEach(input => {
                input.addEventListener('change', function() {
                    answers[currentQuestion - 1] = parseInt(this.value);
                    updateProgress();
                    
                    if (currentQuestion < pcl5Questions.length) {
                        currentQuestion++;
                        setTimeout(() => {
                            renderQuestion();
                        }, 300);
                    } else {
                        setTimeout(() => {
                            renderQuestion();
                        }, 300);
                    }
                });
            });
            
            questionsContainer.appendChild(questionElement);
            
            if (currentPageSpan) currentPageSpan.textContent = currentQuestion;
            
            if (prevBtn) prevBtn.disabled = currentQuestion === 1;
            if (nextBtn) nextBtn.disabled = currentQuestion === pcl5Questions.length;
            if (submitBtn) {
                submitBtn.classList.toggle('hidden', currentQuestion !== pcl5Questions.length);
                
                if (currentQuestion === pcl5Questions.length && answers[currentQuestion - 1] !== null) {
                    submitBtn.disabled = false;
                } else if (currentQuestion === pcl5Questions.length) {
                    submitBtn.disabled = true;
                }
            }
        }

        function getOptionText(value) {
            const texts = {
                0: "一点也不",
                1: "有一点",
                2: "中等程度",
                3: "相当程度",
                4: "非常严重"
            };
            return texts[value];
        }

        function updateProgress() {
            const answeredCount = answers.filter(answer => answer !== null).length;
            const totalQuestions = pcl5Questions.length;
            const progressPercentage = (answeredCount / totalQuestions) * 100;
            
            if (progressFill) progressFill.style.width = `${progressPercentage}%`;
            if (progressText) {
                progressText.textContent = `已回答 ${answeredCount} / ${totalQuestions} 题`;
                if (answeredCount === totalQuestions) {
                    progressText.innerHTML = `<strong>所有问题已回答完毕！可以点击"查看结果"</strong>`;
                }
            }
        }

        function goToPrevQuestion() {
            if (currentQuestion > 1) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function goToNextQuestion() {
            if (currentQuestion < pcl5Questions.length) {
                currentQuestion++;
                renderQuestion();
            }
        }

        function calculateScore() {
            let total = 0;
            answers.forEach(answer => {
                if (answer !== null) total += answer;
            });
            return total;
        }

        function getSeverity(total) {
            for (let level of severityLevels) {
                if (total >= level.min && total <= level.max) return level;
            }
            return severityLevels[0];
        }

        function showResults() {
            const allAnswered = answers.every(answer => answer !== null);
            if (!allAnswered) {
                alert('请回答所有问题后再查看结果！');
                return;
            }
            
            const total = calculateScore();
            const severity = getSeverity(total);
            
            document.getElementById('total-score').textContent = total;
            document.getElementById('severity-level').textContent = severity.level;
            document.getElementById('clinical-cutoff').textContent = total >= 33 ? '达到临床阈值' : '低于临床阈值';
            
            setTimeout(() => {
                const totalBar = document.getElementById('total-bar');
                if (totalBar) {
                    totalBar.style.width = `${(total / 80) * 100}%`;
                }
            }, 100);
            
            generatePTSDSummary(total, severity);
            generateInterpretation(total, severity);
            generateRecommendations(total, severity);
            
            questionnaireSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function generatePTSDSummary(total, severity) {
            const summaryContent = document.getElementById('ptsd-summary-content');
            summaryContent.innerHTML = `
                <div class="ptsd-card ${severity.class}">
                    <h3><i class="fas fa-exclamation-triangle"></i> 总分: ${total} 分 (${severity.level})</h3>
                    <p>${severity.desc}</p>
                    <p>临床参考切割分数为33分，您的得分${total >= 33 ? '已达到' : '未达到'}临床阈值。</p>
                </div>
            `;
        }

        function generateInterpretation(total, severity) {
            const interpretationContent = document.getElementById('interpretation-content');
            let html = `
                <p>PCL-5总分范围为0-80分，分数越高表示PTSD症状越严重。通常33分被视为可能的PTSD临床诊断参考阈值。</p>
                <div class="recommendation-item">
                    <h4>总分解读</h4>
                    <p>您的总分为 <strong>${total}</strong> 分，属于 <strong>${severity.level}</strong> 范围。${severity.desc}</p>
                </div>
            `;
            
            // 亚量表得分简析（可选）
            const intrusion = answers.slice(0,5).filter(a=>a!==null).reduce((s,a)=>s+a,0);
            const avoidance = answers.slice(5,7).filter(a=>a!==null).reduce((s,a)=>s+a,0);
            const cognition = answers.slice(7,14).filter(a=>a!==null).reduce((s,a)=>s+a,0);
            const arousal = answers.slice(14,20).filter(a=>a!==null).reduce((s,a)=>s+a,0);
            
            html += `
                <div class="recommendation-item">
                    <h4>各症状群得分</h4>
                    <ul>
                        <li><strong>侵入性症状</strong> (问题1-5): ${intrusion}/20 分</li>
                        <li><strong>回避症状</strong> (问题6-7): ${avoidance}/8 分</li>
                        <li><strong>认知和情绪负性改变</strong> (问题8-14): ${cognition}/28 分</li>
                        <li><strong>警觉性与反应性改变</strong> (问题15-20): ${arousal}/24 分</li>
                    </ul>
                </div>
            `;
            
            interpretationContent.innerHTML = html;
        }

        function generateRecommendations(total, severity) {
            const recommendationsContent = document.getElementById('recommendations-content');
            let html = `
                <div class="recommendation-item">
                    <h4><i class="fas fa-brain"></i> 自我关怀</h4>
                    <p>无论得分如何，照顾好自己的心理健康都很重要。保持规律作息，适度运动，与信任的人保持联系。</p>
                </div>
            `;
            
            if (total < 33) {
                html += `
                    <div class="recommendation-item">
                        <h4><i class="fas fa-smile"></i> 维持现状</h4>
                        <p>您的得分低于临床阈值，可能没有明显的PTSD症状。但如果这些症状仍然困扰您，也可以寻求专业支持。</p>
                    </div>
                `;
            } else {
                html += `
                    <div class="recommendation-item">
                        <h4><i class="fas fa-user-md"></i> 专业评估</h4>
                        <p>您的得分已达到或超过临床参考阈值，建议尽快咨询心理健康专业人士（如精神科医生、心理治疗师）进行全面评估。</p>
                    </div>
                    <div class="recommendation-item">
                        <h4><i class="fas fa-hand-holding-heart"></i> 支持资源</h4>
                        <p>您可以联系当地心理健康中心、心理援助热线或寻求创伤专业治疗。有效的治疗方法包括认知行为疗法、眼动脱敏再处理（EMDR）等。</p>
                    </div>
                `;
            }
            
            html += `
                <div class="recommendation-item">
                    <h4><i class="fas fa-book"></i> 了解更多</h4>
                    <p>关于创伤后应激障碍的知识，可以查阅权威资料或咨询专业人士。PTSD是可以治疗的，寻求帮助是勇敢的一步。</p>
                </div>
            `;
            
            recommendationsContent.innerHTML = html;
        }

        function restartQuestionnaire() {
            answers = new Array(pcl5Questions.length).fill(null);
            currentQuestion = 1;
            updateProgress();
            resultsSection.classList.add('hidden');
            instructionsSection.classList.remove('hidden');
            instructionsSection.scrollIntoView({ behavior: 'smooth' });
        }

        function printResults() {
            const printWindow = window.open('', '_blank');
            const total = calculateScore();
            const severity = getSeverity(total);
            
            printWindow.document.write(`
                <html>
                <head>
                    <title>PCL-5 创伤后应激症状筛查报告</title>
                    <style>
                        body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; }
                        h1, h2, h3 { color: #333; }
                        .score-table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        .score-table th, .score-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
                        .score-table th { background-color: #f2f2f2; }
                        .ptsd-box { padding: 15px; margin: 15px 0; border-radius: 8px; }
                        .level-normal { background-color: #d4edda; border-left: 6px solid #28a745; }
                        .level-mild { background-color: #fff3cd; border-left: 6px solid #ffc107; }
                        .level-moderate { background-color: #fff3cd; border-left: 6px solid #fd7e14; }
                        .level-severe { background-color: #f8d7da; border-left: 6px solid #dc3545; }
                        .recommendation { background-color: #f8f9fa; padding: 15px; margin: 15px 0; }
                        .footer { margin-top: 30px; font-size: 12px; color: #666; text-align: center; }
                        ul { padding-left: 20px; }
                        li { margin-bottom: 5px; }
                    </style>
                </head>
                <body>
                    <h1>PCL-5 创伤后应激症状筛查报告</h1>
                    <p><strong>测试日期：</strong> ${new Date().toLocaleDateString('zh-CN')}</p>
                    
                    <h2>总分</h2>
                    <p><strong>总分：</strong> ${total} / 80</p>
                    <p><strong>症状水平：</strong> ${severity.level}</p>
                    <p><strong>临床参考：</strong> ${total >= 33 ? '达到临床阈值' : '低于临床阈值'}</p>
                    
                    <h2>各症状群得分</h2>
                    <table class="score-table">
                        <tr><th>症状群</th><th>得分</th><th>可能范围</th></tr>
                        <tr><td>侵入性症状</td><td>${answers.slice(0,5).filter(a=>a!==null).reduce((s,a)=>s+a,0)}</td><td>0-20</td></tr>
                        <tr><td>回避症状</td><td>${answers.slice(5,7).filter(a=>a!==null).reduce((s,a)=>s+a,0)}</td><td>0-8</td></tr>
                        <tr><td>认知和情绪负性改变</td><td>${answers.slice(7,14).filter(a=>a!==null).reduce((s,a)=>s+a,0)}</td><td>0-28</td></tr>
                        <tr><td>警觉性与反应性改变</td><td>${answers.slice(14,20).filter(a=>a!==null).reduce((s,a)=>s+a,0)}</td><td>0-24</td></tr>
                    </table>
                    
                    <h2>结果解读</h2>
                    <div class="ptsd-box ${severity.class}">
                        <p>您的总分为 ${total} 分，属于 ${severity.level} 范围。${severity.desc}</p>
                        <p>临床参考切割分数为33分，您的得分${total >= 33 ? '已达到' : '未达到'}临床阈值。</p>
                    </div>
                    
                    <h2>心鸟心理测试-重要提示</h2>
                    <div class="recommendation">
                        <p>本量表仅用于自我筛查，不能替代专业临床诊断。如果您的得分较高或这些症状对您造成困扰，请寻求心理健康专业人士的帮助。</p>
                    </div>
                    
                    <div class="footer">
                        <p>创伤后应激症状筛查（PCL-5）基于DSM-5标准</p>
                        <p>参考: Weathers, F.W., Litz, B.T., Keane, T.M., Palmieri, P.A., Marx, B.P., & Schnurr, P.P. (2013). The PTSD Checklist for DSM-5 (PCL-5).</p>
                        <p>© ${new Date().getFullYear()} 心理健康工具 | 仅供教育参考使用</p>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => printWindow.print(), 250);
        }
    </script>
</body>
</html>